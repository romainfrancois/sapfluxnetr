<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>sapfluxnetr (Not So) Quick Guide • sapfluxnetr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="sapfluxnetr (Not So) Quick Guide">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sapfluxnetr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.5.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/custom-aggregation.html">Custom aggregation</a>
    </li>
    <li>
      <a href="../articles/data-flags.html">Data Flags</a>
    </li>
    <li>
      <a href="../articles/memory-and-parallelization.html">Memory and Parallelization</a>
    </li>
    <li>
      <a href="../articles/metadata-and-data-units.html">Metadata and Data units</a>
    </li>
    <li>
      <a href="../articles/sapfluxnetr-quick-guide.html">sapfluxnetr (Not So) Quick Guide</a>
    </li>
    <li>
      <a href="../articles/sfn-data-classes.html">sfn_data classes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sapfluxnet/sapfluxnetr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>sapfluxnetr (Not So) Quick Guide</h1>
                        <h4 class="author">Víctor Granda (SAPFLUXNET Team)</h4>
            
            <h4 class="date">2019-03-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sapfluxnet/sapfluxnetr/blob/master/vignettes/sapfluxnetr-quick-guide.Rmd"><code>vignettes/sapfluxnetr-quick-guide.Rmd</code></a></small>
      <div class="hidden name"><code>sapfluxnetr-quick-guide.Rmd</code></div>

    </div>

    
    
<p><code>sapfluxnetr</code> R package provides tools for a tidy data analysis for the first sap flow measurements global database (<a href="http://sapfluxnet.creaf.cat/app">SAPFLUXNET Project</a>). In this vignette you will learn how to install the package, download the data and get started with some data metrics.</p>
<div id="installing-the-package" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-the-package" class="anchor"></a>Installing the package</h2>
<p><code>sapfluxnetr</code> is not yet in CRAN, so the installation must be done with the <a href="">remotes</a> package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># if (!require(remotes)) {install.packages('remotes')}</span></a>
<a class="sourceLine" id="cb1-2" title="2">remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(</a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="st">'sapfluxnet/sapfluxnetr'</span>,</a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="dt">build_opts =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"--no-resave-data"</span>, <span class="st">"--no-manual"</span>, <span class="st">"--build-vignettes"</span>)</a>
<a class="sourceLine" id="cb1-5" title="5">)</a></code></pre></div>
<p>Development versions of the package reside in github. If you want the latest updates, <strong>and also the latest bugs</strong> ( be advised ;) ), please install the devel branch of the <a href="https://github.com/sapfluxnet/sapfluxnetr">github repository</a> with the <code>devtools</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># if (!require(remotes)) {install.packages('remotes')}</span></a>
<a class="sourceLine" id="cb2-2" title="2">remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(</a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="st">'sapfluxnet/sapfluxnetr'</span>, <span class="dt">ref =</span> <span class="st">'devel'</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="dt">build_opts =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"--no-resave-data"</span>, <span class="st">"--no-manual"</span>, <span class="st">"--build-vignettes"</span>)</a>
<a class="sourceLine" id="cb2-5" title="5">)</a></code></pre></div>
<p>Now you can load the package, along with the <code>tidyverse</code> package, as it will be needed later:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sapfluxnetr)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co"># if (!require(tidyverse)) {install.packages('tidyverse')}</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; ── Attaching packages ───────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; ✔ ggplot2 3.1.0     ✔ purrr   0.3.0</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; ✔ tibble  2.0.0     ✔ dplyr   0.7.8</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; ✔ tidyr   0.8.2     ✔ stringr 1.3.1</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; ✔ readr   1.3.1     ✔ forcats 0.3.0</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; ── Conflicts ──────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></a></code></pre></div>
</div>
<div id="download-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#download-the-data" class="anchor"></a>Download the data</h2>
<div id="zenodo" class="section level3">
<h3 class="hasAnchor">
<a href="#zenodo" class="anchor"></a>Zenodo</h3>
<p>During the embargo period (2019-03-05 to 2020-03-05) only the data contributors can access the data. If you are a data contributor willing to access the data, follow these steps:</p>
<ol style="list-style-type: decimal">
<li>Go to SAPFLUXNET repository in Zenodo (<a href="https://zenodo.org/record/2530798" class="uri">https://zenodo.org/record/2530798</a>)</li>
<li>Click in the <code>Request access</code> button, fill the form and click the <code>Send request</code> button.</li>
<li>SAPFLUXNET Team will send you an email with the link to activate your access to the Zenodo repository.</li>
<li>Follow the link and click in the download button. This will download a zip file</li>
<li>Unzip the file in any location</li>
<li>You are ready to go ;)</li>
</ol>
</div>
<div id="sapfluxnet-data-estructure" class="section level3">
<h3 class="hasAnchor">
<a href="#sapfluxnet-data-estructure" class="anchor"></a>SAPFLUXNET Data estructure</h3>
<p>SAPFLUXNET database estrucuture is as follows:</p>
<pre><code>0.1.3 (database version number)
  |
  |-- RData
  |    |
  |    |-- plant
  |    |-- sapwood
  |    |-- leaf
  |
  |-- csv
  |    |
  |    |-- plant
  |    |-- sapwood
  |    |-- leaf</code></pre>
<p><code>RData</code> folder contains the RData files for each site divided by sap flow units level:</p>
<ul>
<li>
<code>plant</code> sites with sap flow plant level units available.<br>
</li>
<li>
<code>sapwood</code> sites with sap flow sapwood level units available.<br>
</li>
<li>
<code>leaf</code> sites with sap flow leaf level units available.</li>
</ul>
<p><code>csv</code> folder contains the csv files (9 files, 5 of metadata, 2 of data and 2 more for the data flags) for each units level available and site. We do not provide scripts or functions to work with the csv files, only the RData objects.</p>
<p>To start working with the data, you have two options:</p>
<ul>
<li><p>If working in RStudio, create a project in the data root folder (<code>0.1.3</code> in this example) and follow the examples in this vignette to get started.</p></li>
<li><p>If not, set the data root folder (<code>0.1.3</code> in this example) as the working directory with <code>setwd</code> and follow the examples in this vignette to get started.</p></li>
</ul>
<blockquote>
<p>DISCLAIMER: In order to be able to build the vignette in the CRAN tests the following examples will be based on a small subset of SAPFLUXNET Data, composed by <code>ARG_TRE</code>, <code>ARG_MAZ</code> and <code>AUS_CAN_ST2_MIX</code> sites. Outputs may vary if you follow the vignette examples with the complete database.</p>
</blockquote>
</div>
</div>
<div id="inspecting-a-site" class="section level2">
<h2 class="hasAnchor">
<a href="#inspecting-a-site" class="anchor"></a>Inspecting a site</h2>
<p>First, let’s get used to the data structure that SAPFLUXNET provides, and for that we will choose a site and start playing with it.</p>
<div id="loading-a-site" class="section level3">
<h3 class="hasAnchor">
<a href="#loading-a-site" class="anchor"></a>Loading a site</h3>
<p>In this example we will use the <code>ARG_MAZ</code> site, as it is small and it will be fast seeing the package capabilities. There are sites like <code>FRA_PUE</code> 100 times bigger than this, but as one can imagine, the time is also increasing when analising those bigger datasets.<br>
So, let’s read the data in the environment:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># read the data</span></a>
<a class="sourceLine" id="cb5-2" title="2">arg_maz &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_sfn_data.html">read_sfn_data</a></span>(<span class="st">'ARG_MAZ'</span>, <span class="dt">folder =</span> <span class="st">'RData/plant'</span>)</a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co"># see a brief summary of the site:</span></a>
<a class="sourceLine" id="cb5-5" title="5">arg_maz</a></code></pre></div>
<pre><code>#&gt; sfn_data object
#&gt; Data from ARG_MAZ site
#&gt; 
#&gt; Data kindly provided by  Sebastian Pfautsch  from  University of Sydney
#&gt; and  Pablo Peri  from  Instituto Nacional de Tecnología Agropecuaria 
#&gt; 
#&gt; Site related literature:  DOI 10.1007/s00468-013-0935-4 
#&gt; 
#&gt; Sapflow data:  288  observations of  5  trees/plants
#&gt; Species present:  Nothofagus pumilio 
#&gt; 
#&gt; Environmental data:  288  observations.
#&gt; Variables present:
#&gt;   ta rh vpd sw_in ws precip swc_shallow ppfd_in ext_rad 
#&gt; 
#&gt; Biome:  Mediterranean 
#&gt; 
#&gt; TIMESTAMP span:  2009-11-19 -03--2009-11-30 23:00:00 -03 
#&gt; 
#&gt; Solar TIMESTAMP span:  2009-11-18 22:24:18 UTC--2009-11-30 21:20:24 UTC 
#&gt; 
#&gt; Sapflow data flags:
#&gt; No flags present
#&gt; 
#&gt; Environmental data flags:
#&gt; RANGE_WARN   OUT_WARN CALCULATED 
#&gt;          9         17        576</code></pre>
<p>At first glance, we know by this summary that is an Argentinian forest (first three letters of the site code are always the country code), contributed by Sebastian Pfautsch and Pablo Peri with 5 <em>Nothofagus pumilio</em> trees measured along 15 days in 2009. Also we can see the environmental variables measured (<code>ta</code>, <code>rh</code>, <code>vpd</code>, <code>sw_in</code>, <code>ws</code>, <code>precip</code>, <code>swc_shallow</code>, <code>ppfd_in</code> and <code>ext_rad</code>) and the biome classification. Finally, we can see that the environmental data has some flags (more on that later).</p>
</div>
<div id="accesing-the-data-and-the-metadata" class="section level3">
<h3 class="hasAnchor">
<a href="#accesing-the-data-and-the-metadata" class="anchor"></a>Accesing the data and the metadata</h3>
<p><code>sfn_data</code> objects have different slots containing the different data, each of one has an accesor function (see <code><a href="../reference/sfn_get_methods.html">?sfn_get_methods</a></code> and <code>vignette('sfn-data-classes', package = 'sapfluxnetr'</code> for detailed info):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># sapf data with original site timestamp</span></a>
<a class="sourceLine" id="cb7-2" title="2">arg_maz_sapf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_get_generics.html">get_sapf_data</a></span>(arg_maz, <span class="dt">solar =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-3" title="3">arg_maz_sapf</a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; # A time tibble: 288 x 6</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; # Index: TIMESTAMP</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt;    TIMESTAMP           ARG_MAZ_Npu_Jt_1 ARG_MAZ_Npu_Jt_2 ARG_MAZ_Npu_Jt_3</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt;    &lt;dttm&gt;                         &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt;  1 2009-11-19 00:00:00            1955.             754.             742.</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt;  2 2009-11-19 01:00:00            1833.             752.             631.</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt;  3 2009-11-19 02:00:00            1817.             795.             597.</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt;  4 2009-11-19 03:00:00            1598.             788.             579.</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt;  5 2009-11-19 04:00:00            1419.             780.             518.</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt;  6 2009-11-19 05:00:00            1506.             735.             430.</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt;  7 2009-11-19 06:00:00            1649.             720.             539.</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt;  8 2009-11-19 07:00:00            1630.             882.             542.</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt;  9 2009-11-19 08:00:00            1909.            1015.             655.</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt; 10 2009-11-19 09:00:00            2849.            1459.             930.</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#&gt; # … with 278 more rows, and 2 more variables: ARG_MAZ_Npu_Jt_4 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#&gt; #   ARG_MAZ_Npu_Jt_5 &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-20" title="20"></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co"># env_data with calculated aparent solar time</span></a>
<a class="sourceLine" id="cb7-22" title="22">arg_maz_env &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_get_generics.html">get_env_data</a></span>(arg_maz, <span class="dt">solar =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-23" title="23">arg_maz_env</a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">#&gt; # A time tibble: 288 x 10</span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co">#&gt; # Index: TIMESTAMP</span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="co">#&gt;    TIMESTAMP              ta    rh   vpd sw_in    ws precip swc_shallow</span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="co">#&gt;    &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="co">#&gt;  1 2009-11-18 22:24:18  4.99  55.6 0.387     0  12.9    0         0.359</span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="co">#&gt;  2 2009-11-18 23:24:18  4.57  60   0.339     0   9.7    0         0.359</span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="co">#&gt;  3 2009-11-19 00:24:02  4.99  60.4 0.345     0  11.3    0         0.358</span></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co">#&gt;  4 2009-11-19 01:24:02  3.31  66   0.263     0   9.7    0.2       0.357</span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co">#&gt;  5 2009-11-19 02:24:02  2.03  68.7 0.221     0  12.9    0         0.357</span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="co">#&gt;  6 2009-11-19 03:24:02  2.46  58.8 0.300     0  17.7    0         0.356</span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co">#&gt;  7 2009-11-19 04:24:02  2.46  55.2 0.327     0  17.7    0         0.356</span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">#&gt;  8 2009-11-19 05:24:02  2.89  53.7 0.348     3  14.5    0         0.356</span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co">#&gt;  9 2009-11-19 06:24:02  4.15  52.8 0.388    78   9.7    0         0.356</span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co">#&gt; 10 2009-11-19 07:24:02  5.4   43.2 0.509   275  11.3    0         0.355</span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="co">#&gt; # … with 278 more rows, and 2 more variables: ppfd_in &lt;dbl&gt;, ext_rad &lt;dbl&gt;</span></a></code></pre></div>
<p>You can see that the TIMESTAMP variable changes between both kinds of data. That is because the TIMESTAMP returned is controled by the <code>solar</code> parameter (see <code><a href="../reference/sfn_get_methods.html">?sfn_get_methods</a></code>).</p>
<p>Metadata can be accesed in the same way:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">arg_maz_site_md &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_get_generics.html">get_site_md</a></span>(arg_maz)</a>
<a class="sourceLine" id="cb8-2" title="2">arg_maz_site_md</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; # A tibble: 1 x 24</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt;   si_addcontr_ema… si_addcontr_fir… si_addcontr_ins… si_addcontr_las…</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt;   &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; 1 peri.pablo@inta… Pablo            Instituto Nacio… Peri            </span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; # … with 20 more variables: si_code &lt;chr&gt;, si_contact_email &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; #   si_contact_firstname &lt;chr&gt;, si_contact_institution &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; #   si_contact_lastname &lt;chr&gt;, si_country &lt;chr&gt;, si_dendro_network &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; #   si_dist_mgmt &lt;chr&gt;, si_elev &lt;int&gt;, si_flux_network &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt; #   si_igbp &lt;chr&gt;, si_lat &lt;dbl&gt;, si_long &lt;dbl&gt;, si_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt; #   si_paper &lt;chr&gt;, si_remarks &lt;lgl&gt;, is_inside_country &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt; #   si_mat &lt;dbl&gt;, si_map &lt;dbl&gt;, si_biome &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb8-14" title="14">arg_maz_stand_md &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_get_generics.html">get_stand_md</a></span>(arg_maz)</a>
<a class="sourceLine" id="cb8-15" title="15">arg_maz_stand_md</a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt; # A tibble: 1 x 18</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">#&gt;   st_age st_aspect st_basal_area st_clay_perc st_density st_growth_condi…</span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;             &lt;dbl&gt; &lt;lgl&gt;             &lt;int&gt; &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#&gt; 1    180 E                  59.1 NA                  518 Naturally regen…</span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">#&gt; # … with 12 more variables: st_height &lt;int&gt;, st_lai &lt;lgl&gt;, st_name &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">#&gt; #   st_remarks &lt;lgl&gt;, st_sand_perc &lt;lgl&gt;, st_silt_perc &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">#&gt; #   st_soil_depth &lt;lgl&gt;, st_soil_texture &lt;chr&gt;, st_terrain &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="co">#&gt; #   st_treatment &lt;lgl&gt;, si_code &lt;chr&gt;, st_USDA_soil_texture &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb8-24" title="24">arg_maz_species_md &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_get_generics.html">get_species_md</a></span>(arg_maz)</a>
<a class="sourceLine" id="cb8-25" title="25">arg_maz_species_md</a>
<a class="sourceLine" id="cb8-26" title="26"><span class="co">#&gt; # A tibble: 1 x 5</span></a>
<a class="sourceLine" id="cb8-27" title="27"><span class="co">#&gt;   sp_basal_area_perc sp_leaf_habit  sp_name            sp_ntrees si_code</span></a>
<a class="sourceLine" id="cb8-28" title="28"><span class="co">#&gt;                &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;                  &lt;int&gt; &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb8-29" title="29"><span class="co">#&gt; 1                100 cold deciduous Nothofagus pumilio         5 ARG_MAZ</span></a>
<a class="sourceLine" id="cb8-30" title="30">arg_maz_plant_md &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_get_generics.html">get_plant_md</a></span>(arg_maz)</a>
<a class="sourceLine" id="cb8-31" title="31">arg_maz_plant_md</a>
<a class="sourceLine" id="cb8-32" title="32"><span class="co">#&gt; # A tibble: 5 x 26</span></a>
<a class="sourceLine" id="cb8-33" title="33"><span class="co">#&gt;   pl_age pl_azimut_int pl_bark_thick pl_code pl_dbh pl_height pl_leaf_area</span></a>
<a class="sourceLine" id="cb8-34" title="34"><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;lgl&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-35" title="35"><span class="co">#&gt; 1    180 Corrected, m…          14.7 ARG_MA…   41.1 NA               109. </span></a>
<a class="sourceLine" id="cb8-36" title="36"><span class="co">#&gt; 2    180 No azimuthal…          13   ARG_MA…   33.2 NA                58.4</span></a>
<a class="sourceLine" id="cb8-37" title="37"><span class="co">#&gt; 3    180 No azimuthal…           6   ARG_MA…   23.2 NA                35.0</span></a>
<a class="sourceLine" id="cb8-38" title="38"><span class="co">#&gt; 4    180 No azimuthal…          21   ARG_MA…   55.6 NA               174. </span></a>
<a class="sourceLine" id="cb8-39" title="39"><span class="co">#&gt; 5    180 No azimuthal…          10   ARG_MA…   38   NA                88  </span></a>
<a class="sourceLine" id="cb8-40" title="40"><span class="co">#&gt; # … with 19 more variables: pl_name &lt;chr&gt;, pl_radial_int &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb8-41" title="41"><span class="co">#&gt; #   pl_remarks &lt;lgl&gt;, pl_sap_units &lt;chr&gt;, pl_sapw_area &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb8-42" title="42"><span class="co">#&gt; #   pl_sapw_depth &lt;dbl&gt;, pl_sens_calib &lt;lgl&gt;, pl_sens_cor_grad &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb8-43" title="43"><span class="co">#&gt; #   pl_sens_cor_zero &lt;chr&gt;, pl_sens_hgt &lt;dbl&gt;, pl_sens_length &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb8-44" title="44"><span class="co">#&gt; #   pl_sens_man &lt;chr&gt;, pl_sens_meth &lt;chr&gt;, pl_sens_timestep &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb8-45" title="45"><span class="co">#&gt; #   pl_social &lt;chr&gt;, pl_species &lt;chr&gt;, pl_treatment &lt;lgl&gt;, si_code &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb8-46" title="46"><span class="co">#&gt; #   pl_sap_units_orig &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb8-47" title="47">arg_maz_env_md &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_get_generics.html">get_env_md</a></span>(arg_maz)</a>
<a class="sourceLine" id="cb8-48" title="48">arg_maz_env_md</a>
<a class="sourceLine" id="cb8-49" title="49"><span class="co">#&gt; # A tibble: 1 x 17</span></a>
<a class="sourceLine" id="cb8-50" title="50"><span class="co">#&gt;   env_leafarea_se… env_netrad env_plant_watpot env_ppfd_in env_precip</span></a>
<a class="sourceLine" id="cb8-51" title="51"><span class="co">#&gt;   &lt;lgl&gt;            &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;       &lt;chr&gt;     </span></a>
<a class="sourceLine" id="cb8-52" title="52"><span class="co">#&gt; 1 NA               Not provi… leaf: midday     Not provid… Clearing  </span></a>
<a class="sourceLine" id="cb8-53" title="53"><span class="co">#&gt; # … with 12 more variables: env_remarks &lt;lgl&gt;, env_rh &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb8-54" title="54"><span class="co">#&gt; #   env_swc_deep_depth &lt;lgl&gt;, env_swc_shallow_depth &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb8-55" title="55"><span class="co">#&gt; #   env_sw_in &lt;chr&gt;, env_ta &lt;chr&gt;, env_time_daylight &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb8-56" title="56"><span class="co">#&gt; #   env_timestep &lt;int&gt;, env_time_zone &lt;chr&gt;, env_vpd &lt;chr&gt;, env_ws &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb8-57" title="57"><span class="co">#&gt; #   si_code &lt;chr&gt;</span></a></code></pre></div>
<p>If in doubt about some of the metadata variables (what it means, units…) a description can be obtained from <code>describe_md_variable</code> function:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># what is env_ta?</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw"><a href="../reference/describe_md_variable.html">describe_md_variable</a></span>(<span class="st">'env_ta'</span>)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt; Description:</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; Location of air temperature sensor</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt; Values:</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt; Above canopy | Within canopy | Clearing | Off-site | Not provided | </span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt; Units:</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; Fixed values</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; Type:</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; Character</span></a>
<a class="sourceLine" id="cb9-14" title="14"></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co"># or pl_species?</span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="kw"><a href="../reference/describe_md_variable.html">describe_md_variable</a></span>(<span class="st">'pl_species'</span>)</a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#&gt; Description:</span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">#&gt; Species identity of the measured plant</span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co">#&gt; Values:</span></a>
<a class="sourceLine" id="cb9-21" title="21"><span class="co">#&gt; Contributor defined | </span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">#&gt; Units:</span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co">#&gt; Scientific name without author abbreviation, as accepted by The Plant List</span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-26" title="26"><span class="co">#&gt; Type:</span></a>
<a class="sourceLine" id="cb9-27" title="27"><span class="co">#&gt; Character</span></a></code></pre></div>
<p>There is also some accessors that can come in handy sometimes. <code>get_timestamp</code> and <code>get_solar_timestamp</code> access to the original timestamp and the apparent solar time timestamp. <code>get_si_code</code> access to the site code. See <code>vignette('sfn-data-classes', package = 'sapfluxnetr'</code> for more info.</p>
<div id="flags" class="section level4">
<h4 class="hasAnchor">
<a href="#flags" class="anchor"></a>Flags</h4>
<p><code>sfn_data</code> objects also have two more slots, accesed with <code>get_sapf_flags</code> and <code>get_env_flags</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">arg_maz_sapf_flags &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_get_generics.html">get_sapf_flags</a></span>(arg_maz, <span class="dt">solar =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">arg_maz_sapf_flags</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt; # A time tibble: 288 x 6</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt; # Index: TIMESTAMP</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt;    TIMESTAMP           ARG_MAZ_Npu_Jt_1 ARG_MAZ_Npu_Jt_2 ARG_MAZ_Npu_Jt_3</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt;    &lt;dttm&gt;              &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt;  1 2009-11-18 22:24:18 ""               ""               ""              </span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt;  2 2009-11-18 23:24:18 ""               ""               ""              </span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt;  3 2009-11-19 00:24:02 ""               ""               ""              </span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt;  4 2009-11-19 01:24:02 ""               ""               ""              </span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt;  5 2009-11-19 02:24:02 ""               ""               ""              </span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt;  6 2009-11-19 03:24:02 ""               ""               ""              </span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt;  7 2009-11-19 04:24:02 ""               ""               ""              </span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">#&gt;  8 2009-11-19 05:24:02 ""               ""               ""              </span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">#&gt;  9 2009-11-19 06:24:02 ""               ""               ""              </span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">#&gt; 10 2009-11-19 07:24:02 ""               ""               ""              </span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">#&gt; # … with 278 more rows, and 2 more variables: ARG_MAZ_Npu_Jt_4 &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="co">#&gt; #   ARG_MAZ_Npu_Jt_5 &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb10-19" title="19"></a>
<a class="sourceLine" id="cb10-20" title="20">arg_maz_env_flags &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_get_generics.html">get_env_flags</a></span>(arg_maz, <span class="dt">solar =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-21" title="21">arg_maz_env_flags</a>
<a class="sourceLine" id="cb10-22" title="22"><span class="co">#&gt; # A time tibble: 288 x 10</span></a>
<a class="sourceLine" id="cb10-23" title="23"><span class="co">#&gt; # Index: TIMESTAMP</span></a>
<a class="sourceLine" id="cb10-24" title="24"><span class="co">#&gt;    TIMESTAMP           ta    rh    vpd   sw_in ws    precip swc_shallow</span></a>
<a class="sourceLine" id="cb10-25" title="25"><span class="co">#&gt;    &lt;dttm&gt;              &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;      </span></a>
<a class="sourceLine" id="cb10-26" title="26"><span class="co">#&gt;  1 2009-11-18 22:24:18 ""    ""    ""    ""    ""    ""     ""         </span></a>
<a class="sourceLine" id="cb10-27" title="27"><span class="co">#&gt;  2 2009-11-18 23:24:18 ""    ""    ""    ""    ""    ""     ""         </span></a>
<a class="sourceLine" id="cb10-28" title="28"><span class="co">#&gt;  3 2009-11-19 00:24:02 ""    ""    ""    ""    ""    ""     ""         </span></a>
<a class="sourceLine" id="cb10-29" title="29"><span class="co">#&gt;  4 2009-11-19 01:24:02 ""    ""    ""    ""    ""    OUT_W… ""         </span></a>
<a class="sourceLine" id="cb10-30" title="30"><span class="co">#&gt;  5 2009-11-19 02:24:02 ""    ""    ""    ""    ""    ""     ""         </span></a>
<a class="sourceLine" id="cb10-31" title="31"><span class="co">#&gt;  6 2009-11-19 03:24:02 ""    ""    ""    ""    ""    ""     ""         </span></a>
<a class="sourceLine" id="cb10-32" title="32"><span class="co">#&gt;  7 2009-11-19 04:24:02 ""    ""    ""    ""    ""    ""     ""         </span></a>
<a class="sourceLine" id="cb10-33" title="33"><span class="co">#&gt;  8 2009-11-19 05:24:02 ""    ""    ""    ""    ""    ""     ""         </span></a>
<a class="sourceLine" id="cb10-34" title="34"><span class="co">#&gt;  9 2009-11-19 06:24:02 ""    ""    ""    ""    ""    ""     ""         </span></a>
<a class="sourceLine" id="cb10-35" title="35"><span class="co">#&gt; 10 2009-11-19 07:24:02 ""    ""    ""    ""    ""    ""     ""         </span></a>
<a class="sourceLine" id="cb10-36" title="36"><span class="co">#&gt; # … with 278 more rows, and 2 more variables: ppfd_in &lt;chr&gt;, ext_rad &lt;chr&gt;</span></a></code></pre></div>
<p>This datsets store any flag that each data point may have (possible outlier, data removed in the Quality Check of the data…). For a complete list of flags possible values see <code><a href="../articles/data-flags.html">vignette('data-flags', package = 'sapfluxnetr')</a></code>. As an example, let’s see which values are marked as “RANGE_WARN” (a warning indicating that the value may be out of normal variable range):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">arg_maz_env_flags <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw">filter_all</span>(<span class="kw">any_vars</span>(stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(., <span class="st">'RANGE_WARN'</span>)))</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">#&gt; # A time tibble: 9 x 10</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt; # Index: TIMESTAMP</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt;   TIMESTAMP           ta    rh    vpd   sw_in ws    precip swc_shallow</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt;   &lt;dttm&gt;              &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;      </span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt; 1 2009-11-25 13:22:41 ""    ""    ""    ""    RANG… ""     ""         </span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#&gt; 2 2009-11-26 08:22:30 ""    ""    ""    ""    RANG… ""     ""         </span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">#&gt; 3 2009-11-26 09:22:30 ""    ""    ""    ""    RANG… ""     ""         </span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt; 4 2009-11-26 10:22:31 ""    ""    ""    ""    RANG… ""     ""         </span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#&gt; 5 2009-11-26 11:22:31 ""    ""    ""    ""    RANG… ""     ""         </span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">#&gt; 6 2009-11-26 12:22:32 ""    ""    ""    ""    RANG… ""     ""         </span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">#&gt; 7 2009-11-26 13:22:32 ""    ""    ""    ""    RANG… ""     ""         </span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co">#&gt; 8 2009-11-28 10:21:09 ""    ""    ""    ""    RANG… ""     ""         </span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">#&gt; 9 2009-11-28 12:21:09 ""    ""    ""    ""    RANG… ""     ""         </span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">#&gt; # … with 2 more variables: ppfd_in &lt;chr&gt;, ext_rad &lt;chr&gt;</span></a></code></pre></div>
<p>We see that the out of range warnings refer to wind variable. We can cross the data to see which values of wind speed are giving the warnings,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">arg_maz_env_flags <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span><span class="kw">filter_all</span>(<span class="kw">any_vars</span>(stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(., <span class="st">'RANGE_WARN'</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw">semi_join</span>(arg_maz_env, ., <span class="dt">by =</span> <span class="st">'TIMESTAMP'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">  </span><span class="kw">select</span>(TIMESTAMP, ws)</a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">#&gt; # A time tibble: 9 x 2</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">#&gt; # Index: TIMESTAMP</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">#&gt;   TIMESTAMP              ws</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">#&gt;   &lt;dttm&gt;              &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="co">#&gt; 1 2009-11-25 13:22:41  45.1</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co">#&gt; 2 2009-11-26 08:22:30  48.3</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">#&gt; 3 2009-11-26 09:22:30  51.5</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co">#&gt; 4 2009-11-26 10:22:31  48.3</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co">#&gt; 5 2009-11-26 11:22:31  62.8</span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">#&gt; 6 2009-11-26 12:22:32  57.9</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">#&gt; 7 2009-11-26 13:22:32  48.3</span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co">#&gt; 8 2009-11-28 10:21:09  46.7</span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="co">#&gt; 9 2009-11-28 12:21:09  48.3</span></a></code></pre></div>
<p>and confirm that the warnings refer to values above the “usual” wind speed maximum.</p>
</div>
</div>
<div id="plotting-an-object" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-an-object" class="anchor"></a>Plotting an object</h3>
<p>We can also plot the different data with the help of <code>sfn_plot</code> function. It will return <code>ggplot</code> objects that can be modified afterwards:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="../reference/sfn_plot.html">sfn_plot</a></span>(arg_maz, <span class="dt">type =</span> <span class="st">'sapf'</span>, <span class="dt">solar =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Tree) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">'none'</span>)</a></code></pre></div>
<p><img src="sapfluxnetr-quick-guide_files/figure-html/sapf_plot-1.png" width="576"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw"><a href="../reference/sfn_plot.html">sfn_plot</a></span>(arg_maz, <span class="dt">type =</span> <span class="st">'env'</span>, <span class="dt">solar =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Variable, <span class="dt">scales =</span> <span class="st">'free_y'</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">'none'</span>)</a></code></pre></div>
<p><img src="sapfluxnetr-quick-guide_files/figure-html/env_plot-1.png" width="576"></p>
<p>We can also plot environmental variables individually (with the <code>type</code> argument), or an environmental variable <em>versus</em> the sap flow measurements (with the <code>formula_env</code> argument). See <code><a href="../reference/sfn_plot.html">?sfn_plot</a></code> for a complete description of the available plots.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># vpd individually</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw"><a href="../reference/sfn_plot.html">sfn_plot</a></span>(arg_maz, <span class="dt">type =</span> <span class="st">'vpd'</span>, <span class="dt">solar =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co"># vpd vs sapf</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="kw"><a href="../reference/sfn_plot.html">sfn_plot</a></span>(arg_maz, <span class="dt">formula_env =</span> <span class="op">~</span>vpd, <span class="dt">solar =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">'none'</span>)</a></code></pre></div>
<p><img src="sapfluxnetr-quick-guide_files/figure-html/vpd_and_vs-1.png" width="700"><img src="sapfluxnetr-quick-guide_files/figure-html/vpd_and_vs-2.png" width="700"></p>
</div>
<div id="aggregation-metrics" class="section level3">
<h3 class="hasAnchor">
<a href="#aggregation-metrics" class="anchor"></a>Aggregation metrics</h3>
<p>SAPFLUXNET data is stored as subdaily measures with different timestep between sites (ranging from 10 minutes to 2 hours) for both, sap flow and environmental data. Aggregation metrics are calculated for both kinds of data.<br><code>sapfluxnetr</code> offers some simple, yet complete aggregation functions returning some pre-defined metrics: <code>daily_metrics</code>, <code>monthly_metrics</code>, <code>predawn_metrics</code>, <code>midday_metrics</code>, <code>daylight_metrics</code> and <code>nightly_metrics</code>.<br><code>daily_metrics</code> and <code>monthly_metrics</code> perform a daily and monthly aggregation, respectively, with a set of predefined metrics. <code>predawn_metrics</code>, <code>midday_metrics</code>, <code>daylight_metrics</code> and <code>nightly_metrics</code> perform daily or monthly aggregations (controlled by the <code>period</code> argument) by hour-defined intervals, also with a set of predefined metrics.</p>
<p>Predefined metrics are:</p>
<ol style="list-style-type: decimal">
<li><em>mean</em></li>
<li><em>standard deviation</em></li>
<li>
<em>accumulated</em> for the precipitation data</li>
<li>
<em>data coverage</em> (percentage of period covered by the raw data)</li>
<li><em>quantile 95</em></li>
<li>
<em>diurnal centroid</em> (Only calculated <strong>for sap flow</strong> measurements when using <code>daily_metrics</code>, see <code><a href="../reference/diurnal_centroid.html">?diurnal_centroid</a></code> for limitations in the calculation of this metric)</li>
</ol>
<p>Let’s see some examples:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">arg_maz_daily &lt;-<span class="st"> </span><span class="kw"><a href="../reference/metrics.html">daily_metrics</a></span>(arg_maz, <span class="dt">solar =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co">#&gt; [1] "Crunching data for ARG_MAZ. In large datasets this could take a while"</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">#&gt; [1] "General data for ARG_MAZ"</span></a>
<a class="sourceLine" id="cb16-4" title="4"></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(arg_maz_daily)</a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co">#&gt; [1] "sapf" "env"</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(arg_maz_daily[[<span class="st">'sapf'</span>]])</a>
<a class="sourceLine" id="cb16-8" title="8"><span class="co">#&gt;  [1] "TIMESTAMP"                 "ARG_MAZ_Npu_Jt_1_mean"    </span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co">#&gt;  [3] "ARG_MAZ_Npu_Jt_2_mean"     "ARG_MAZ_Npu_Jt_3_mean"    </span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">#&gt;  [5] "ARG_MAZ_Npu_Jt_4_mean"     "ARG_MAZ_Npu_Jt_5_mean"    </span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="co">#&gt;  [7] "ARG_MAZ_Npu_Jt_1_sd"       "ARG_MAZ_Npu_Jt_2_sd"      </span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co">#&gt;  [9] "ARG_MAZ_Npu_Jt_3_sd"       "ARG_MAZ_Npu_Jt_4_sd"      </span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co">#&gt; [11] "ARG_MAZ_Npu_Jt_5_sd"       "ARG_MAZ_Npu_Jt_1_coverage"</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="co">#&gt; [13] "ARG_MAZ_Npu_Jt_2_coverage" "ARG_MAZ_Npu_Jt_3_coverage"</span></a>
<a class="sourceLine" id="cb16-15" title="15"><span class="co">#&gt; [15] "ARG_MAZ_Npu_Jt_4_coverage" "ARG_MAZ_Npu_Jt_5_coverage"</span></a>
<a class="sourceLine" id="cb16-16" title="16"><span class="co">#&gt; [17] "ARG_MAZ_Npu_Jt_1_q_95"     "ARG_MAZ_Npu_Jt_2_q_95"    </span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="co">#&gt; [19] "ARG_MAZ_Npu_Jt_3_q_95"     "ARG_MAZ_Npu_Jt_4_q_95"    </span></a>
<a class="sourceLine" id="cb16-18" title="18"><span class="co">#&gt; [21] "ARG_MAZ_Npu_Jt_5_q_95"     "ARG_MAZ_Npu_Jt_1_centroid"</span></a>
<a class="sourceLine" id="cb16-19" title="19"><span class="co">#&gt; [23] "ARG_MAZ_Npu_Jt_2_centroid" "ARG_MAZ_Npu_Jt_3_centroid"</span></a>
<a class="sourceLine" id="cb16-20" title="20"><span class="co">#&gt; [25] "ARG_MAZ_Npu_Jt_4_centroid" "ARG_MAZ_Npu_Jt_5_centroid"</span></a>
<a class="sourceLine" id="cb16-21" title="21"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(arg_maz_daily[[<span class="st">'env'</span>]])</a>
<a class="sourceLine" id="cb16-22" title="22"><span class="co">#&gt;  [1] "TIMESTAMP"            "ta_mean"              "rh_mean"             </span></a>
<a class="sourceLine" id="cb16-23" title="23"><span class="co">#&gt;  [4] "vpd_mean"             "sw_in_mean"           "ws_mean"             </span></a>
<a class="sourceLine" id="cb16-24" title="24"><span class="co">#&gt;  [7] "precip_mean"          "swc_shallow_mean"     "ppfd_in_mean"        </span></a>
<a class="sourceLine" id="cb16-25" title="25"><span class="co">#&gt; [10] "ext_rad_mean"         "ta_sd"                "rh_sd"               </span></a>
<a class="sourceLine" id="cb16-26" title="26"><span class="co">#&gt; [13] "vpd_sd"               "sw_in_sd"             "ws_sd"               </span></a>
<a class="sourceLine" id="cb16-27" title="27"><span class="co">#&gt; [16] "precip_sd"            "swc_shallow_sd"       "ppfd_in_sd"          </span></a>
<a class="sourceLine" id="cb16-28" title="28"><span class="co">#&gt; [19] "ext_rad_sd"           "ta_coverage"          "rh_coverage"         </span></a>
<a class="sourceLine" id="cb16-29" title="29"><span class="co">#&gt; [22] "vpd_coverage"         "sw_in_coverage"       "ws_coverage"         </span></a>
<a class="sourceLine" id="cb16-30" title="30"><span class="co">#&gt; [25] "precip_coverage"      "swc_shallow_coverage" "ppfd_in_coverage"    </span></a>
<a class="sourceLine" id="cb16-31" title="31"><span class="co">#&gt; [28] "ext_rad_coverage"     "ta_q_95"              "rh_q_95"             </span></a>
<a class="sourceLine" id="cb16-32" title="32"><span class="co">#&gt; [31] "vpd_q_95"             "sw_in_q_95"           "ws_q_95"             </span></a>
<a class="sourceLine" id="cb16-33" title="33"><span class="co">#&gt; [34] "precip_q_95"          "swc_shallow_q_95"     "ppfd_in_q_95"        </span></a>
<a class="sourceLine" id="cb16-34" title="34"><span class="co">#&gt; [37] "ext_rad_q_95"         "precip_accumulated"</span></a></code></pre></div>
<p>We can see that results are divided in <code>sapf</code> and <code>env</code> and inside each of them the metrics are indicated by the end of the variable names.<br>
This way we can select specific variables, for example the 0.95 quantiles of sap flow measures:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">arg_maz_daily[[<span class="st">'sapf'</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span><span class="kw">select</span>(TIMESTAMP, <span class="kw">ends_with</span>(<span class="st">'q_95'</span>))</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">#&gt; # A time tibble: 13 x 6</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">#&gt; # Index: TIMESTAMP</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">#&gt;    TIMESTAMP           ARG_MAZ_Npu_Jt_… ARG_MAZ_Npu_Jt_… ARG_MAZ_Npu_Jt_…</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#&gt;    &lt;dttm&gt;                         &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">#&gt;  1 2009-11-18 00:00:00            1949.             754.             736.</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">#&gt;  2 2009-11-19 00:00:00            4603.            2835.            1692.</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co">#&gt;  3 2009-11-20 00:00:00            2561.            1289.             801.</span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co">#&gt;  4 2009-11-21 00:00:00            4001.            2459.            1508.</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="co">#&gt;  5 2009-11-22 00:00:00            4396.            2761.            1466.</span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co">#&gt;  6 2009-11-23 00:00:00            5192.            3160.            1842.</span></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="co">#&gt;  7 2009-11-24 00:00:00            5135.            3160.            1879.</span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="co">#&gt;  8 2009-11-25 00:00:00            4724.            3077.            1522.</span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="co">#&gt;  9 2009-11-26 00:00:00            5642.            3449.            1845.</span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="co">#&gt; 10 2009-11-27 00:00:00            6560.            4174.            2251.</span></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="co">#&gt; 11 2009-11-28 00:00:00            7142.            4288.            2362.</span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="co">#&gt; 12 2009-11-29 00:00:00            5319.            3494.            2000.</span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="co">#&gt; 13 2009-11-30 00:00:00            2408.            1804.             711.</span></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="co">#&gt; # … with 2 more variables: ARG_MAZ_Npu_Jt_4_q_95 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="co">#&gt; #   ARG_MAZ_Npu_Jt_5_q_95 &lt;dbl&gt;</span></a></code></pre></div>
<p>The same is applicable to the environmental data, in this case the mean values:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">arg_maz_daily[[<span class="st">'env'</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">  </span><span class="kw">select</span>(TIMESTAMP, <span class="kw">ends_with</span>(<span class="st">'mean'</span>))</a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co">#&gt; # A time tibble: 13 x 10</span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co">#&gt; # Index: TIMESTAMP</span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="co">#&gt;    TIMESTAMP           ta_mean rh_mean vpd_mean sw_in_mean ws_mean</span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="co">#&gt;    &lt;dttm&gt;                &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co">#&gt;  1 2009-11-18 00:00:00   4.78     57.8    0.363         0     11.3</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co">#&gt;  2 2009-11-19 00:00:00   5.56     45.7    0.521       300.    12.0</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co">#&gt;  3 2009-11-20 00:00:00   1.39     73.5    0.181       134.    12.6</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co">#&gt;  4 2009-11-21 00:00:00   2.44     69.6    0.236       207.    14.2</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co">#&gt;  5 2009-11-22 00:00:00   2.21     71.9    0.216       282.    15.8</span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="co">#&gt;  6 2009-11-23 00:00:00   3.19     56.7    0.364       335.    11.4</span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="co">#&gt;  7 2009-11-24 00:00:00   6.16     52.1    0.511       312.    13.7</span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="co">#&gt;  8 2009-11-25 00:00:00   6.11     58.5    0.409       250.    21.7</span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="co">#&gt;  9 2009-11-26 00:00:00   4.99     72.4    0.269       218.    34.2</span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="co">#&gt; 10 2009-11-27 00:00:00   4.98     61.2    0.363       336.    25.8</span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="co">#&gt; 11 2009-11-28 00:00:00   5.87     61.6    0.411       212.    25.2</span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co">#&gt; 12 2009-11-29 00:00:00   1.45     63.6    0.266       246.    17.7</span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="co">#&gt; 13 2009-11-30 00:00:00   0.299    78.0    0.140       241.    18.0</span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="co">#&gt; # … with 4 more variables: precip_mean &lt;dbl&gt;, swc_shallow_mean &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="co">#&gt; #   ppfd_in_mean &lt;dbl&gt;, ext_rad_mean &lt;dbl&gt;</span></a></code></pre></div>
<p>If interested in custom metrics or custom aggregations, there is a generic function, <code>sfn_metrics</code> that allows for customization of the statistics to calculate and the periods to aggregate. See <code><a href="../reference/sfn_metrics.html">?sfn_metrics</a></code> and <code>vignette('custom-aggregation'. package = 'sapfluxnetr')</code> for more details about it.</p>
<div id="timestamp-format-in-aggregations" class="section level4">
<h4 class="hasAnchor">
<a href="#timestamp-format-in-aggregations" class="anchor"></a>TIMESTAMP format in aggregations</h4>
<p>It’s worth to mention that aggregated TIMESTAMPS are fixed to the <strong>beginning</strong> of the period aggregated, meaning that data from <code>2018-01-01 00:00:00</code> to <code>2018-01-01 23:59:59</code> are aggregated as <code>2018-01-01 00:00:00</code>.<br>
You can change this using the <code>side</code> parameter (see <code><a href="../reference/sfn_metrics.html">?sfn_metrics</a></code>)</p>
</div>
<div id="tidy-metrics" class="section level4">
<h4 class="hasAnchor">
<a href="#tidy-metrics" class="anchor"></a>Tidy metrics</h4>
<p>The default returned object for this aggregation functions is a list with the sap flow and the environmental data, but given that usually is more confortable to have all data (sap flow and environmental) and ancillary data (metadata) altogether in a tidy data frame (each row an observation), all aggregation functions have an argument, <code>tidy</code> that can be setted to <em>TRUE</em> to obtain this kind of data frame. We will cover this in the <a href="#tidymetrics">“Tidy metrics”</a> section.</p>
</div>
</div>
</div>
<div id="working-with-multiple-sites" class="section level2">
<h2 class="hasAnchor">
<a href="#working-with-multiple-sites" class="anchor"></a>Working with multiple sites</h2>
<p>Getting the insights about one site is interesting, but getting the insights of a common group of sites could be even more interesting. <code>sapfluxnetr</code> allows filtering sites by metadata values (biomes, countries, species…) and work with them as a unique set.</p>
<div id="metadatadatabase" class="section level3">
<h3 class="hasAnchor">
<a href="#metadatadatabase" class="anchor"></a>Building the metadata database</h3>
<p>First thing we have to do is creating a metadata database. It is not mandatory, but filtering sites by metadata can be a very time and resources consuming step if we have to temporary build the database each time we want filter sites. So, let’s create a cached metadata database. This will take some minutes, so maybe it is a good moment to prepare a hot beverage ;)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">sfn_metadata &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_sfn_metadata.html">read_sfn_metadata</a></span>(<span class="dt">folder =</span> <span class="st">'RData/plant'</span>, <span class="dt">.write_cache =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>#&gt; [1] "processing site ARG_MAZ (1 of 3)"
#&gt; [1] "processing site ARG_TRE (2 of 3)"
#&gt; [1] "processing site AUS_CAN_ST2_MIX (3 of 3)"</code></pre>
<p>The important bit here is <code>.write_cache = TRUE</code>. This will write a file called <code>.metadata_cache.RData</code> containing all the metadata for all sites present in <code>folder</code>. This file will be used any time we will filter the metadata, so there is no need of accessing all the data again.<br>
If we take a look at <code>sfn_metadata</code> we can see a list with 5 data frames, one for each metadata class (site, stand, species, plant and environmental metadata).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># access plant metadata</span></a>
<a class="sourceLine" id="cb21-2" title="2">sfn_metadata[[<span class="st">'plant_md'</span>]]</a>
<a class="sourceLine" id="cb21-3" title="3"><span class="co">#&gt; # A tibble: 43 x 26</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co">#&gt;    pl_age pl_azimut_int pl_bark_thick pl_code pl_dbh pl_height pl_leaf_area</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co">#&gt;     &lt;dbl&gt; &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co">#&gt;  1  180   Corrected, m…          14.7 ARG_MA…   41.1      NA          109. </span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="co">#&gt;  2  180   No azimuthal…          13   ARG_MA…   33.2      NA           58.4</span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="co">#&gt;  3  180   No azimuthal…           6   ARG_MA…   23.2      NA           35.0</span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="co">#&gt;  4  180   No azimuthal…          21   ARG_MA…   55.6      NA          174. </span></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="co">#&gt;  5  180   No azimuthal…          10   ARG_MA…   38        NA           88  </span></a>
<a class="sourceLine" id="cb21-11" title="11"><span class="co">#&gt;  6  140   Corrected, m…          23.5 ARG_TR…   23.6      NA           29.7</span></a>
<a class="sourceLine" id="cb21-12" title="12"><span class="co">#&gt;  7  140   No azimuthal…          22.5 ARG_TR…   20.2      NA           13.0</span></a>
<a class="sourceLine" id="cb21-13" title="13"><span class="co">#&gt;  8  140   No azimuthal…          22   ARG_TR…   23.8      NA           29.8</span></a>
<a class="sourceLine" id="cb21-14" title="14"><span class="co">#&gt;  9  140   No azimuthal…          23.5 ARG_TR…   19.5      NA           15.1</span></a>
<a class="sourceLine" id="cb21-15" title="15"><span class="co">#&gt; 10   14.5 No azimuthal…          NA   AUS_CA…   13.1      14.3         NA  </span></a>
<a class="sourceLine" id="cb21-16" title="16"><span class="co">#&gt; # … with 33 more rows, and 19 more variables: pl_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb21-17" title="17"><span class="co">#&gt; #   pl_radial_int &lt;chr&gt;, pl_remarks &lt;chr&gt;, pl_sap_units &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb21-18" title="18"><span class="co">#&gt; #   pl_sapw_area &lt;dbl&gt;, pl_sapw_depth &lt;dbl&gt;, pl_sens_calib &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb21-19" title="19"><span class="co">#&gt; #   pl_sens_cor_grad &lt;chr&gt;, pl_sens_cor_zero &lt;chr&gt;, pl_sens_hgt &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb21-20" title="20"><span class="co">#&gt; #   pl_sens_length &lt;int&gt;, pl_sens_man &lt;chr&gt;, pl_sens_meth &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb21-21" title="21"><span class="co">#&gt; #   pl_sens_timestep &lt;int&gt;, pl_social &lt;chr&gt;, pl_species &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb21-22" title="22"><span class="co">#&gt; #   pl_treatment &lt;chr&gt;, si_code &lt;chr&gt;, pl_sap_units_orig &lt;chr&gt;</span></a></code></pre></div>
</div>
<div id="listing-the-sites-in-a-folder-and-filtering-by-metadata" class="section level3">
<h3 class="hasAnchor">
<a href="#listing-the-sites-in-a-folder-and-filtering-by-metadata" class="anchor"></a>Listing the sites in a folder and filtering by metadata</h3>
<p>Now that we have our metadata database built, we can inspect the site codes in a folder with <code>sfn_sites_in_folder</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">folder &lt;-<span class="st"> 'RData/plant/'</span></a>
<a class="sourceLine" id="cb22-2" title="2">sites &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_sites_in_folder.html">sfn_sites_in_folder</a></span>(folder)</a>
<a class="sourceLine" id="cb22-3" title="3">sites</a></code></pre></div>
<pre><code>#&gt; [1] "ARG_MAZ"         "ARG_TRE"         "AUS_CAN_ST2_MIX"</code></pre>
<p>We can filter these sites by any metadata variable, to select those that met some criteria. This is done with <code>filter_sites_by_md</code>. As a first try, let’s list all sites belonging to temperate forest biome (mediterranean included):</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">temperate &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_sites_in_folder.html">sfn_sites_in_folder</a></span>(folder) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/filter_sites_by_md.html">filter_sites_by_md</a></span>(</a>
<a class="sourceLine" id="cb24-3" title="3">    si_biome <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'Mediterranean'</span>, <span class="st">'Temperate forest'</span>),</a>
<a class="sourceLine" id="cb24-4" title="4">    <span class="dt">metadata =</span> sfn_metadata</a>
<a class="sourceLine" id="cb24-5" title="5">  )</a>
<a class="sourceLine" id="cb24-6" title="6"></a>
<a class="sourceLine" id="cb24-7" title="7">temperate</a></code></pre></div>
<pre><code>#&gt; [1] "ARG_MAZ"         "ARG_TRE"         "AUS_CAN_ST2_MIX"</code></pre>
<p>You can combine all filters you want:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">temperate_hr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sfn_sites_in_folder.html">sfn_sites_in_folder</a></span>(folder) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/filter_sites_by_md.html">filter_sites_by_md</a></span>(</a>
<a class="sourceLine" id="cb26-3" title="3">    si_biome <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'Mediterranean'</span>, <span class="st">'Temperate forest'</span>),</a>
<a class="sourceLine" id="cb26-4" title="4">    pl_sens_meth <span class="op">==</span><span class="st"> 'HR'</span>,</a>
<a class="sourceLine" id="cb26-5" title="5">    <span class="dt">metadata =</span> sfn_metadata</a>
<a class="sourceLine" id="cb26-6" title="6">  )</a>
<a class="sourceLine" id="cb26-7" title="7"></a>
<a class="sourceLine" id="cb26-8" title="8">temperate_hr</a></code></pre></div>
<pre><code>#&gt; [1] "ARG_MAZ" "ARG_TRE"</code></pre>
<p>Remember that you can get all the info from a metadata variable with <code>describe_md_variable</code>, and also you can get a complete list of metadata variables for filtering with <code>sfn_vars_to_filter</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw"><a href="../reference/sfn_vars_to_filter.html">sfn_vars_to_filter</a></span>()</a>
<a class="sourceLine" id="cb28-2" title="2"><span class="co">#&gt; $site_md</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="co">#&gt;  [1] "si_name"                 "si_country"             </span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="co">#&gt;  [3] "si_contact_firstname"    "si_contact_lastname"    </span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="co">#&gt;  [5] "si_contact_email"        "si_contact_institution" </span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="co">#&gt;  [7] "si_addcontr_firstname"   "si_addcontr_lastname"   </span></a>
<a class="sourceLine" id="cb28-7" title="7"><span class="co">#&gt;  [9] "si_addcontr_email"       "si_addcontr_institution"</span></a>
<a class="sourceLine" id="cb28-8" title="8"><span class="co">#&gt; [11] "si_lat"                  "si_long"                </span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="co">#&gt; [13] "si_elev"                 "si_paper"               </span></a>
<a class="sourceLine" id="cb28-10" title="10"><span class="co">#&gt; [15] "si_dist_mgmt"            "si_igbp"                </span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="co">#&gt; [17] "si_flux_network"         "si_dendro_network"      </span></a>
<a class="sourceLine" id="cb28-12" title="12"><span class="co">#&gt; [19] "si_remarks"              "si_code"                </span></a>
<a class="sourceLine" id="cb28-13" title="13"><span class="co">#&gt; [21] "si_mat"                  "si_map"                 </span></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="co">#&gt; [23] "si_biome"               </span></a>
<a class="sourceLine" id="cb28-15" title="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="co">#&gt; $stand_md</span></a>
<a class="sourceLine" id="cb28-17" title="17"><span class="co">#&gt;  [1] "st_name"              "st_growth_condition"  "st_treatment"        </span></a>
<a class="sourceLine" id="cb28-18" title="18"><span class="co">#&gt;  [4] "st_age"               "st_height"            "st_density"          </span></a>
<a class="sourceLine" id="cb28-19" title="19"><span class="co">#&gt;  [7] "st_basal_area"        "st_lai"               "st_aspect"           </span></a>
<a class="sourceLine" id="cb28-20" title="20"><span class="co">#&gt; [10] "st_terrain"           "st_soil_depth"        "st_soil_texture"     </span></a>
<a class="sourceLine" id="cb28-21" title="21"><span class="co">#&gt; [13] "st_sand_perc"         "st_silt_perc"         "st_clay_perc"        </span></a>
<a class="sourceLine" id="cb28-22" title="22"><span class="co">#&gt; [16] "st_remarks"           "st_USDA_soil_texture"</span></a>
<a class="sourceLine" id="cb28-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-24" title="24"><span class="co">#&gt; $species_md</span></a>
<a class="sourceLine" id="cb28-25" title="25"><span class="co">#&gt; [1] "sp_name"            "sp_ntrees"          "sp_leaf_habit"     </span></a>
<a class="sourceLine" id="cb28-26" title="26"><span class="co">#&gt; [4] "sp_basal_area_perc"</span></a>
<a class="sourceLine" id="cb28-27" title="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-28" title="28"><span class="co">#&gt; $plant_md</span></a>
<a class="sourceLine" id="cb28-29" title="29"><span class="co">#&gt;  [1] "pl_name"           "pl_species"        "pl_treatment"     </span></a>
<a class="sourceLine" id="cb28-30" title="30"><span class="co">#&gt;  [4] "pl_dbh"            "pl_height"         "pl_age"           </span></a>
<a class="sourceLine" id="cb28-31" title="31"><span class="co">#&gt;  [7] "pl_social"         "pl_sapw_area"      "pl_sapw_depth"    </span></a>
<a class="sourceLine" id="cb28-32" title="32"><span class="co">#&gt; [10] "pl_bark_thick"     "pl_leaf_area"      "pl_sens_meth"     </span></a>
<a class="sourceLine" id="cb28-33" title="33"><span class="co">#&gt; [13] "pl_sens_man"       "pl_sens_cor_grad"  "pl_sens_cor_zero" </span></a>
<a class="sourceLine" id="cb28-34" title="34"><span class="co">#&gt; [16] "pl_sens_calib"     "pl_sap_units"      "pl_sap_units_orig"</span></a>
<a class="sourceLine" id="cb28-35" title="35"><span class="co">#&gt; [19] "pl_sens_length"    "pl_sens_hgt"       "pl_sens_timestep" </span></a>
<a class="sourceLine" id="cb28-36" title="36"><span class="co">#&gt; [22] "pl_radial_int"     "pl_azimut_int"     "pl_remarks"       </span></a>
<a class="sourceLine" id="cb28-37" title="37"><span class="co">#&gt; [25] "pl_code"          </span></a>
<a class="sourceLine" id="cb28-38" title="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-39" title="39"><span class="co">#&gt; $env_md</span></a>
<a class="sourceLine" id="cb28-40" title="40"><span class="co">#&gt;  [1] "env_time_zone"         "env_time_daylight"    </span></a>
<a class="sourceLine" id="cb28-41" title="41"><span class="co">#&gt;  [3] "env_timestep"          "env_ta"               </span></a>
<a class="sourceLine" id="cb28-42" title="42"><span class="co">#&gt;  [5] "env_rh"                "env_vpd"              </span></a>
<a class="sourceLine" id="cb28-43" title="43"><span class="co">#&gt;  [7] "env_sw_in"             "env_ppfd_in"          </span></a>
<a class="sourceLine" id="cb28-44" title="44"><span class="co">#&gt;  [9] "env_netrad"            "env_ws"               </span></a>
<a class="sourceLine" id="cb28-45" title="45"><span class="co">#&gt; [11] "env_precip"            "env_swc_shallow_depth"</span></a>
<a class="sourceLine" id="cb28-46" title="46"><span class="co">#&gt; [13] "env_swc_deep_depth"    "env_plant_watpot"     </span></a>
<a class="sourceLine" id="cb28-47" title="47"><span class="co">#&gt; [15] "env_leafarea_seasonal" "env_remarks"</span></a>
<a class="sourceLine" id="cb28-48" title="48"></a>
<a class="sourceLine" id="cb28-49" title="49"><span class="co"># and see what values we must use for filtering by pl_sens_meth</span></a>
<a class="sourceLine" id="cb28-50" title="50"><span class="kw"><a href="../reference/describe_md_variable.html">describe_md_variable</a></span>(<span class="st">'pl_sens_meth'</span>)</a>
<a class="sourceLine" id="cb28-51" title="51"><span class="co">#&gt; Description:</span></a>
<a class="sourceLine" id="cb28-52" title="52"><span class="co">#&gt; Sap flow measures method</span></a>
<a class="sourceLine" id="cb28-53" title="53"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-54" title="54"><span class="co">#&gt; Values:</span></a>
<a class="sourceLine" id="cb28-55" title="55"><span class="co">#&gt; CAG | HD | CHP | CHD | HFD | HPTM | HR | SFPLUS | SHB | TSHB | Other/unknown | </span></a>
<a class="sourceLine" id="cb28-56" title="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-57" title="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-58" title="58"><span class="co">#&gt; Units:</span></a>
<a class="sourceLine" id="cb28-59" title="59"><span class="co">#&gt; Fixed values</span></a>
<a class="sourceLine" id="cb28-60" title="60"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb28-61" title="61"><span class="co">#&gt; Type:</span></a>
<a class="sourceLine" id="cb28-62" title="62"><span class="co">#&gt; Character</span></a></code></pre></div>
</div>
<div id="sfn_data_multi-objects" class="section level3">
<h3 class="hasAnchor">
<a href="#sfn_data_multi-objects" class="anchor"></a>sfn_data_multi objects</h3>
<p>We can load all temperate sites with a simple pipe</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">temperate_sites &lt;-<span class="st"> </span>temperate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/read_sfn_data.html">read_sfn_data</a></span>(<span class="dt">folder =</span> <span class="st">'RData/plant'</span>)</a>
<a class="sourceLine" id="cb29-3" title="3">temperate_sites</a></code></pre></div>
<pre><code>#&gt; sfn_data_multi object
#&gt; 3 sites: ARG_MAZ ARG_TRE AUS_CAN_ST2_MIX
#&gt; Approximate time span (UTC) for the combined sites: 2006-06-20 10:54:42 UTC--2009-11-18 22:24:18 UTC</code></pre>
<p>This creates an <code>sfn_data_multi</code> object, which is just a list, but adapted to contain <code>sfn_data</code> objects. Main functions of <code>sapfluxnetr</code> work with this type of objects. As in any list, we can access the sites:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">temperate_sites[[<span class="st">'AUS_CAN_ST2_MIX'</span>]]</a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co">#&gt; sfn_data object</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="co">#&gt; Data from AUS_CAN_ST2_MIX site</span></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-5" title="5"><span class="co">#&gt; Data kindly provided by  David Forrester  from  </span></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="co">#&gt; Swiss Federal Institute for Forest, Snow and Landscape Research WSL</span></a>
<a class="sourceLine" id="cb31-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-8" title="8"><span class="co">#&gt; Site related literature:  10.1016/j.foreco.2009.07.036 </span></a>
<a class="sourceLine" id="cb31-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-10" title="10"><span class="co">#&gt; Sapflow data:  17808  observations of  34  trees/plants</span></a>
<a class="sourceLine" id="cb31-11" title="11"><span class="co">#&gt; Species present:  Eucalyptus globulus, Acacia mearnsii </span></a>
<a class="sourceLine" id="cb31-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-13" title="13"><span class="co">#&gt; Environmental data:  17808  observations.</span></a>
<a class="sourceLine" id="cb31-14" title="14"><span class="co">#&gt; Variables present:</span></a>
<a class="sourceLine" id="cb31-15" title="15"><span class="co">#&gt;   ta vpd sw_in ws precip ppfd_in rh ext_rad </span></a>
<a class="sourceLine" id="cb31-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-17" title="17"><span class="co">#&gt; Biome:  Mediterranean </span></a>
<a class="sourceLine" id="cb31-18" title="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-19" title="19"><span class="co">#&gt; TIMESTAMP span:  2006-06-20 11:00:00 +10--2007-06-26 10:30:00 +10 </span></a>
<a class="sourceLine" id="cb31-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-21" title="21"><span class="co">#&gt; Solar TIMESTAMP span:  2006-06-20 10:54:42 UTC--2007-06-26 10:23:32 UTC </span></a>
<a class="sourceLine" id="cb31-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-23" title="23"><span class="co">#&gt; Sapflow data flags:</span></a>
<a class="sourceLine" id="cb31-24" title="24"><span class="co">#&gt; OUT_REMOVED    NA_ADDED    OUT_WARN  NA_PRESENT </span></a>
<a class="sourceLine" id="cb31-25" title="25"><span class="co">#&gt;          40        3400        5460      504952 </span></a>
<a class="sourceLine" id="cb31-26" title="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb31-27" title="27"><span class="co">#&gt; Environmental data flags:</span></a>
<a class="sourceLine" id="cb31-28" title="28"><span class="co">#&gt;   OUT_WARN   NA_ADDED CALCULATED </span></a>
<a class="sourceLine" id="cb31-29" title="29"><span class="co">#&gt;      10826      15320      53424</span></a>
<a class="sourceLine" id="cb31-30" title="30"><span class="co"># temperate_sites[[3]] # the same</span></a>
<a class="sourceLine" id="cb31-31" title="31"><span class="co"># temperate_sites$AUS_CAN_ST2_MIX # the same</span></a></code></pre></div>
</div>
<div id="multi-aggregation" class="section level3">
<h3 class="hasAnchor">
<a href="#multi-aggregation" class="anchor"></a>Multi aggregation</h3>
<p>Now we can aggregate all sites at once</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">temperate_aggregated &lt;-<span class="st"> </span>temperate_sites <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/metrics.html">daily_metrics</a></span>()</a>
<a class="sourceLine" id="cb32-3" title="3"><span class="co">#&gt; [1] "Crunching data for ARG_MAZ. In large datasets this could take a while"</span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="co">#&gt; [1] "General data for ARG_MAZ"</span></a>
<a class="sourceLine" id="cb32-5" title="5"><span class="co">#&gt; [1] "Crunching data for ARG_TRE. In large datasets this could take a while"</span></a>
<a class="sourceLine" id="cb32-6" title="6"><span class="co">#&gt; [1] "General data for ARG_TRE"</span></a>
<a class="sourceLine" id="cb32-7" title="7"><span class="co">#&gt; [1] "Crunching data for AUS_CAN_ST2_MIX. In large datasets this could take a while"</span></a>
<a class="sourceLine" id="cb32-8" title="8"><span class="co">#&gt; [1] "General data for AUS_CAN_ST2_MIX"</span></a>
<a class="sourceLine" id="cb32-9" title="9"></a>
<a class="sourceLine" id="cb32-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(temperate_aggregated)</a>
<a class="sourceLine" id="cb32-11" title="11"><span class="co">#&gt; [1] "ARG_MAZ"         "ARG_TRE"         "AUS_CAN_ST2_MIX"</span></a></code></pre></div>
<p>and <em>voilà</em>, all sites aggregated and stored in a list, so we can start working with the data.</p>
</div>
</div>
<div id="tidymetrics" class="section level2">
<h2 class="hasAnchor">
<a href="#tidymetrics" class="anchor"></a>Tidy metrics</h2>
<p>Most of the times it comes in handy to have a tidy dataset with all the sap flow and environmental measurements, along with the metadata for the sites aggregated, in order to work with the data in an easier way. This can be done with the <code>metrics_tidyfier</code> function (see <code><a href="../reference/metrics_tidyfier.html">?metrics_tidyfier</a></code>). But <code>daily_metrics</code> and related functions also implement the <code>tidy</code> argument. For the <code>tidy</code> argument to work, we must have available the metadata, see the <a href="#metadatadatabase">“metadata section”</a> for more details about this.</p>
<p>This allows for returning directly a metrics data frame combining all sites aggregated along with their metadata, saving one step in the workflow:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">temperate_tidy &lt;-<span class="st"> </span>temperate_sites <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/metrics.html">daily_metrics</a></span>(<span class="dt">tidy =</span> <span class="ot">TRUE</span>, <span class="dt">metadata =</span> sfn_metadata)</a>
<a class="sourceLine" id="cb33-3" title="3"><span class="co">#&gt; [1] "Crunching data for ARG_MAZ. In large datasets this could take a while"</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="co">#&gt; [1] "General data for ARG_MAZ"</span></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="co">#&gt; [1] "Crunching data for ARG_TRE. In large datasets this could take a while"</span></a>
<a class="sourceLine" id="cb33-6" title="6"><span class="co">#&gt; [1] "General data for ARG_TRE"</span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="co">#&gt; [1] "Crunching data for AUS_CAN_ST2_MIX. In large datasets this could take a while"</span></a>
<a class="sourceLine" id="cb33-8" title="8"><span class="co">#&gt; [1] "General data for AUS_CAN_ST2_MIX"</span></a>
<a class="sourceLine" id="cb33-9" title="9"></a>
<a class="sourceLine" id="cb33-10" title="10">temperate_tidy</a>
<a class="sourceLine" id="cb33-11" title="11"><span class="co">#&gt; # A tibble: 12,769 x 129</span></a>
<a class="sourceLine" id="cb33-12" title="12"><span class="co">#&gt;    TIMESTAMP           si_code pl_code sapflow_centroid sapflow_coverage</span></a>
<a class="sourceLine" id="cb33-13" title="13"><span class="co">#&gt;    &lt;dttm&gt;              &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb33-14" title="14"><span class="co">#&gt;  1 2006-06-20 00:00:00 AUS_CA… AUS_CA…              NaN                0</span></a>
<a class="sourceLine" id="cb33-15" title="15"><span class="co">#&gt;  2 2006-06-20 00:00:00 AUS_CA… AUS_CA…              NaN                0</span></a>
<a class="sourceLine" id="cb33-16" title="16"><span class="co">#&gt;  3 2006-06-20 00:00:00 AUS_CA… AUS_CA…              NaN                0</span></a>
<a class="sourceLine" id="cb33-17" title="17"><span class="co">#&gt;  4 2006-06-20 00:00:00 AUS_CA… AUS_CA…              NaN                0</span></a>
<a class="sourceLine" id="cb33-18" title="18"><span class="co">#&gt;  5 2006-06-20 00:00:00 AUS_CA… AUS_CA…              NaN                0</span></a>
<a class="sourceLine" id="cb33-19" title="19"><span class="co">#&gt;  6 2006-06-20 00:00:00 AUS_CA… AUS_CA…              NaN                0</span></a>
<a class="sourceLine" id="cb33-20" title="20"><span class="co">#&gt;  7 2006-06-20 00:00:00 AUS_CA… AUS_CA…              NaN                0</span></a>
<a class="sourceLine" id="cb33-21" title="21"><span class="co">#&gt;  8 2006-06-20 00:00:00 AUS_CA… AUS_CA…              NaN                0</span></a>
<a class="sourceLine" id="cb33-22" title="22"><span class="co">#&gt;  9 2006-06-20 00:00:00 AUS_CA… AUS_CA…              NaN                0</span></a>
<a class="sourceLine" id="cb33-23" title="23"><span class="co">#&gt; 10 2006-06-20 00:00:00 AUS_CA… AUS_CA…              NaN                0</span></a>
<a class="sourceLine" id="cb33-24" title="24"><span class="co">#&gt; # … with 12,759 more rows, and 124 more variables: sapflow_mean &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-25" title="25"><span class="co">#&gt; #   sapflow_q_95 &lt;dbl&gt;, sapflow_sd &lt;dbl&gt;, ta_mean &lt;dbl&gt;, rh_mean &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-26" title="26"><span class="co">#&gt; #   vpd_mean &lt;dbl&gt;, sw_in_mean &lt;dbl&gt;, ws_mean &lt;dbl&gt;, precip_mean &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-27" title="27"><span class="co">#&gt; #   swc_shallow_mean &lt;dbl&gt;, ppfd_in_mean &lt;dbl&gt;, ext_rad_mean &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-28" title="28"><span class="co">#&gt; #   ta_sd &lt;dbl&gt;, rh_sd &lt;dbl&gt;, vpd_sd &lt;dbl&gt;, sw_in_sd &lt;dbl&gt;, ws_sd &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-29" title="29"><span class="co">#&gt; #   precip_sd &lt;dbl&gt;, swc_shallow_sd &lt;dbl&gt;, ppfd_in_sd &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-30" title="30"><span class="co">#&gt; #   ext_rad_sd &lt;dbl&gt;, ta_coverage &lt;dbl&gt;, rh_coverage &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-31" title="31"><span class="co">#&gt; #   vpd_coverage &lt;dbl&gt;, sw_in_coverage &lt;dbl&gt;, ws_coverage &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-32" title="32"><span class="co">#&gt; #   precip_coverage &lt;dbl&gt;, swc_shallow_coverage &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-33" title="33"><span class="co">#&gt; #   ppfd_in_coverage &lt;dbl&gt;, ext_rad_coverage &lt;dbl&gt;, ta_q_95 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-34" title="34"><span class="co">#&gt; #   rh_q_95 &lt;dbl&gt;, vpd_q_95 &lt;dbl&gt;, sw_in_q_95 &lt;dbl&gt;, ws_q_95 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-35" title="35"><span class="co">#&gt; #   precip_q_95 &lt;dbl&gt;, swc_shallow_q_95 &lt;dbl&gt;, ppfd_in_q_95 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-36" title="36"><span class="co">#&gt; #   ext_rad_q_95 &lt;dbl&gt;, precip_accumulated &lt;dbl&gt;, pl_age &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-37" title="37"><span class="co">#&gt; #   pl_azimut_int &lt;chr&gt;, pl_bark_thick &lt;dbl&gt;, pl_dbh &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-38" title="38"><span class="co">#&gt; #   pl_height &lt;dbl&gt;, pl_leaf_area &lt;dbl&gt;, pl_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb33-39" title="39"><span class="co">#&gt; #   pl_radial_int &lt;chr&gt;, pl_remarks &lt;chr&gt;, pl_sap_units &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb33-40" title="40"><span class="co">#&gt; #   pl_sapw_area &lt;dbl&gt;, pl_sapw_depth &lt;dbl&gt;, pl_sens_calib &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb33-41" title="41"><span class="co">#&gt; #   pl_sens_cor_grad &lt;chr&gt;, pl_sens_cor_zero &lt;chr&gt;, pl_sens_hgt &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-42" title="42"><span class="co">#&gt; #   pl_sens_length &lt;int&gt;, pl_sens_man &lt;chr&gt;, pl_sens_meth &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb33-43" title="43"><span class="co">#&gt; #   pl_sens_timestep &lt;int&gt;, pl_social &lt;chr&gt;, pl_species &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb33-44" title="44"><span class="co">#&gt; #   pl_treatment &lt;chr&gt;, pl_sap_units_orig &lt;chr&gt;, si_addcontr_email &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb33-45" title="45"><span class="co">#&gt; #   si_addcontr_firstname &lt;chr&gt;, si_addcontr_institution &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb33-46" title="46"><span class="co">#&gt; #   si_addcontr_lastname &lt;chr&gt;, si_contact_email &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb33-47" title="47"><span class="co">#&gt; #   si_contact_firstname &lt;chr&gt;, si_contact_institution &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb33-48" title="48"><span class="co">#&gt; #   si_contact_lastname &lt;chr&gt;, si_country &lt;chr&gt;, si_dendro_network &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb33-49" title="49"><span class="co">#&gt; #   si_dist_mgmt &lt;chr&gt;, si_elev &lt;int&gt;, si_flux_network &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb33-50" title="50"><span class="co">#&gt; #   si_igbp &lt;chr&gt;, si_lat &lt;dbl&gt;, si_long &lt;dbl&gt;, si_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb33-51" title="51"><span class="co">#&gt; #   si_paper &lt;chr&gt;, si_remarks &lt;chr&gt;, is_inside_country &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb33-52" title="52"><span class="co">#&gt; #   si_mat &lt;dbl&gt;, si_map &lt;dbl&gt;, si_biome &lt;chr&gt;, st_age &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-53" title="53"><span class="co">#&gt; #   st_aspect &lt;chr&gt;, st_basal_area &lt;dbl&gt;, st_clay_perc &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb33-54" title="54"><span class="co">#&gt; #   st_density &lt;int&gt;, st_growth_condition &lt;chr&gt;, st_height &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-55" title="55"><span class="co">#&gt; #   st_lai &lt;dbl&gt;, st_name &lt;chr&gt;, st_remarks &lt;lgl&gt;, st_sand_perc &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb33-56" title="56"><span class="co">#&gt; #   st_silt_perc &lt;lgl&gt;, st_soil_depth &lt;int&gt;, …</span></a></code></pre></div>
<p>Now we can start analysing, modelling, etc.<br>
For example, to look for site effects in the relationship between sapflow and vpd, using the 0.95 quantiles as maximum values of sapflow and the plant sapwood area as a third variable:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">ggplot</span>(</a>
<a class="sourceLine" id="cb34-2" title="2">  temperate_tidy,</a>
<a class="sourceLine" id="cb34-3" title="3">  <span class="kw">aes</span>(<span class="dt">x =</span> vpd_mean, <span class="dt">y =</span> sapflow_q_<span class="dv">95</span>, <span class="dt">colour =</span> si_code, <span class="dt">size =</span> pl_sapw_area)</a>
<a class="sourceLine" id="cb34-4" title="4">) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb34-6" title="6"><span class="co">#&gt; Warning: Removed 10966 rows containing missing values (geom_point).</span></a></code></pre></div>
<p><img src="sapfluxnetr-quick-guide_files/figure-html/ex_1_plot-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installing-the-package">Installing the package</a></li>
      <li><a href="#download-the-data">Download the data</a></li>
      <li><a href="#inspecting-a-site">Inspecting a site</a></li>
      <li><a href="#working-with-multiple-sites">Working with multiple sites</a></li>
      <li><a href="#tidymetrics">Tidy metrics</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Víctor Granda, Rafael Poyatos, Víctor Flo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
